let forms=document.querySelectorAll("form");function waitForGenesys(e,n=20,s=100){"function"==typeof window.Genesys&&window.Genesys.q?e():n>0?setTimeout((()=>waitForGenesys(e,n-1,s)),s):console.warn("Genesys not available after waiting.")}forms.forEach((function(e){e.addEventListener("click",(function n(){dataLayer.push({event:"formEngagement"}),e.removeEventListener("click",n)}))})),waitForGenesys((()=>{Genesys("subscribe","Conversations.started",(function(){dataLayer.push({event:"chatOpen"})})),Genesys("subscribe","MessagingService.messagesReceived",(function({data:e}){const n=e?.messages?.[0]?.text,s=window.location.hostname,t=s.includes(".co.nz")||s.includes("peninsula-anz-nz"),a=s.includes(".com.au")||s.includes("peninsula-anz-au"),i=n?.match(/[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/);i&&dataLayer.push({event:"chatEmailCapture",email:i});const o=n?.match(/(\+?\d{1,3})?[\s\-]?\(?\d+\)?[\s\-]?\d+[\s\-]?\d+/);if(o){let e=o[0].replace(/[^\d+]/g,""),n="";e.startsWith("0")?a?(e="+61"+e.slice(1),n="AU"):t&&(e="+64"+e.slice(1),n="NZ"):e.startsWith("+")||(a?(e="+61"+e,n="AU"):t&&(e="+64"+e,n="NZ")),dataLayer.push({event:"chatPhoneCapture",hostname:s,phoneNumber:e,country:n})}}))}));